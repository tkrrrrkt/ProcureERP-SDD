# 税区分・税率マスタ エンティティ定義

---

## 1. TaxBusinessCategory（税区分／税務分類）

### ■ 仕様概要
消費税の課税関係および仕入税額控除の判定に用いる
**税務・会計上の分類マスタ**。

### ■ エンティティ定義
| 項目 | 内容 |
|---|---|
| id | UUID（PK） |
| tenant_id | テナントID |
| tax_business_category_code | 税区分コード |
| tax_business_category_name | 税区分名 |
| description | 説明（任意） |
| is_active | 有効フラグ |

### ■ 制約条件
- UNIQUE(tenant_id, tax_business_category_code)
- 物理削除禁止

### ■ 補足
- 税区分は税率と独立して管理する
- 会計・申告処理の判定軸として使用される

---

## 2. TaxRate（税率）

### ■ 仕様概要
消費税率を期間管理付きで保持するマスタ。

### ■ エンティティ定義
| 項目 | 内容 |
|---|---|
| id | UUID（PK） |
| tenant_id | テナントID |
| tax_rate_code | 税率コード |
| rate_percent | 税率（例：8.00 / 10.00） |
| valid_from | 適用開始日 |
| valid_to | 適用終了日（NULL可） |
| is_active | 有効フラグ |

### ■ 制約条件
- UNIQUE(tenant_id, tax_rate_code)
- valid_from <= valid_to（valid_to NULL可）
- 物理削除禁止

### ■ 補足
- 税制改定は新TaxRateの追加で対応する

---

## 3. TaxCode（税区分×税率 関連マスタ）

### ■ 仕様概要
税区分と税率を関連付けた
**税計算および伝票保持のための正本キー**。

### ■ エンティティ定義
| 項目 | 内容 |
|---|---|
| id | UUID（PK） |
| tenant_id | テナントID |
| tax_code | 税コード |
| tax_business_category_id | 税区分ID（FK） |
| tax_rate_id | 税率ID（FK） |
| tax_in_out | 内税／外税区分（enum） |
| is_active | 有効フラグ |

### ■ 制約条件
- UNIQUE(tenant_id, tax_code)
- tax_business_category_id 必須
- tax_rate_id 必須
- tax_in_out：INCLUSIVE / EXCLUSIVE
- 物理削除禁止

### ■ 補足
- 伝票明細は本TaxCodeを保持する
- 税額の端数処理は本マスタでは定義しない

---

## 4. スコープと拡張性（インボイス制度）

- 取引先系マスタ（支払先/請求先など）で「適格請求書発行事業者登録番号（invoice_registration_no）」を保持する。
- 税区分・税率（tax_*）は登録番号の有無を判定・保持しない（税計算ロジックから分離）。

---

以上。
