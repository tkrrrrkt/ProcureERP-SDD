# 品目・仕様・SKU 管理 仕様概要
## 1. 対象範囲
本仕様は、ProcureERP における以下の管理対象を定義する。

- 品目（Item）
- 品目仕様（SKU / Variant）
- 品目属性（仕様属性）
- 品目属性値（選択リスト）

本仕様は、発注・仕入を中心とした購買業務で利用する品目管理を目的とし、
在庫管理・生産管理・BOM 連携は **将来拡張（2次以降）** として考慮するが、
本仕様自体はそれらを阻害しない設計とする。

---

## 2. 設計方針（不変）

- ERPとして正しい正規化を行う
- ただし、SaaSとして初期導入・運用が重くなりすぎないことを優先
- MVPでは以下を満たすことを重視する
  - 品目単位での発注・仕入が可能
  - SKU（仕様）は必要な品目のみ段階的に利用可能
  - 自由入力が在庫の物理キーにならない
- 正本PKはすべて UUID
- 業務コードは人間可読用途（表示・検索・帳票・CSV・外部連携）

---

## 3. 品目とSKU（仕様）の基本構造

### 3.1 品目（Item）
- 発注・仕入の基本単位
- 品目単位で SKU（仕様）を持つことができる
- SKU を持たない品目も許容する

### 3.2 SKU（ItemVariant）
- 品目配下の「仕様違い」を表す
- SKU は **数量集計・取引単位（在庫レベル2相当）**
- SKUの論理一意性は「仕様属性の組合せ」で担保する

### 3.3 ベースSKU（標準仕様）
- 品目作成時に、仕様属性を持たない「ベースSKU」を自動生成する
- ベースSKUは品目の default SKU として扱う
- SKUコード（sub_code）は予約値 `00000` を使用する

---

## 4. 仕様属性（ItemAttribute）の考え方

### 4.1 属性のスコープ
- 仕様属性は **品目専用**
- 全品目共通の汎用属性は持たない

### 4.2 属性の役割区分
仕様属性は、役割により以下に分類する。

- VARIANT_KEY  
  - SKU（仕様）を決定するための属性
  - SKUの一意性判定に利用する
- INSTANCE_KEY  
  - ロット・個体識別を想定した属性
  - 将来の在庫管理（2次）で詳細管理対象となる候補

### 4.3 入力方式
- VARIANT_KEY：選択リスト（マスタ値）のみ
- INSTANCE_KEY：自由入力（TEXT）を許可

---

## 5. 自由入力と在庫管理の切り分け

- 自由入力された値は、在庫の物理管理キーとしては使用しない
- INSTANCE_KEY 属性は、MVPでは情報保持用途に限定する
- 在庫管理（2次）で、ロット・個体管理が必要になった場合に、
  在庫管理用エンティティを追加して対応する

---

## 6. コード体系（確定）

| 項目 | 内容 |
|---|---|
| item_code | 5桁固定 |
| variant_code | 5桁固定（Item配下で一意） |
| ベースSKU | variant_code = `00000`（予約値） |
| 表示用SKU | item_code + "-" + variant_code |

---

## 7. 対象外（本仕様では扱わない）
- 在庫数量管理
- ロット／シリアル在庫管理
- 単位・単位換算
- 荷姿
- 仕入先別品目・単価
- BOM・生産管理連携

これらは 2次以降で別途仕様化する。
