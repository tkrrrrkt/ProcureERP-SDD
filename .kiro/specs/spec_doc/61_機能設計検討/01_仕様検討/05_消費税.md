# 税区分・税率マスタ 仕様概要

## 1. 本書の位置づけ
本書は、ProcureERP（購買管理業務SaaS）における
消費税計算・会計処理・税務申告を見据えた
**税区分（分類）および税率管理の基本仕様**を定義する。

本仕様は、設計検討およびQA壁打ちを経て確定した内容を
税区分・税率マスタ 仕様概要**とする。

---

## 2. プロダクト前提
- プロダクト名：ProcureERP
- 種別：購買管理業務SaaS
- マルチテナント：1テナント = 1自社法人
- RLS境界：tenant_id
- 正本PK：UUID
- 物理削除は禁止し、is_active=false による論理無効化を行う

---

## 3. 税マスタ設計の基本思想

### 3.1 税区分（分類）と税率の分離
税に関する情報は、以下の責務に分離して管理する。

| 区分 | 役割 |
|---|---|
| 税区分（TaxBusinessCategory） | 税務・会計・申告上の分類 |
| 税率（TaxRate） | 消費税率および適用期間 |
| 税コード（TaxCode） | 税区分と税率を結びつけた計算・伝票用キー |

---

## 4. 税区分（TaxBusinessCategory）

### 4.1 定義
税区分は、消費税の課税関係および仕入税額控除の区分を表す
**税務・会計上の分類**である。

例：
- 課税売上
- 課税仕入
- 共通課税仕入
- 非課税取引
- 免税取引
- 対象外取引

### 4.2 役割
- 会計仕訳生成時の判定
- 消費税申告・集計ロジックの基礎区分
- 税率とは独立した意味分類として管理する

---

## 5. 税率（TaxRate）

### 5.1 定義
税率は、消費税の割合を **期間管理付き**で保持する。

### 5.2 税制改定への対応
- 税率改定時は、新たなTaxRateレコードを追加する
- 過去伝票は、当時有効な税率を参照し続ける

---

## 6. 税コード（TaxCode）

### 6.1 定義
税コードは、以下を組み合わせた **税計算および伝票保持の正本キー**である。

- 税区分（TaxBusinessCategory）
- 税率（TaxRate）
- 内税／外税区分

### 6.2 役割
- 伝票明細に直接保持される税のキー
- 税額計算、会計処理、税集計の基点

---

## 7. スコープと拡張性
- 本仕様は、税区分・税率・税コードの定義に限定する
- 品目、取引先、仕入先への紐づけや初期値ルールは本書に含めない
- 将来の拡張（税グループ、マトリクス、丸め例外等）を妨げない構造とする
- インボイス制度（適格請求書）対応として、取引先法人（Party）に invoice_registration_no を保持する（登録番号の有無は取引・会計連携で利用）
- 登録番号の形式チェックや国税庁照合などの検証機能はMVP対象外とし、将来拡張で対応する

---

以上。
